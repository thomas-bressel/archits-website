<aside app-overlay 
       [ngClass]="isOverlayOpen() ? 'opened':'closed'" 
       (overlayToggled)="toggleOverlay($event)" 
       [interfaceService]="overlayDatas()">
</aside>

@let blocs = blocsData();

<div class="documentation__bloc">
    @for (section of blocs; track $index) {

    <section [id]="section.id" class="documentation__section">

        <!-- Main H2 header section -->
        <h2 class="documentation__h2Title">{{section.h2Title}}</h2>
        <p class="documentation__text">{{section.text}}</p>


        <!-- Little cards-->
        @if(section.cards) {
        <ul class="documentation__cards">
            @for (card of section.cards ; track $index) {
            <li class="documentation__card">
                <h5  class="documentation__card-title"><span>{{card.icon}}</span>{{card.title}}</h5>
                <p  class="documentation__card-text">{{card.text}}</p>
            </li>
            }
        </ul>
        }

        <!-- Alert boxes -->
        @if (section.alerts) {
        <ul>
            @for (alert of section.alerts ; track $index) {
            <li class="documentation__alert" [ngClass]="`bg-${alert.bgColor} border-${alert.borderColor}`">
                <p class="documentation__text-p"><span >{{alert.icon}}</span >{{alert.text}}</p>
            </li>
            }
        </ul>
        }

        <!-- Sub Bloc-->
        @if (section.subBlocs) {
        <ul>
            @for(subBloc of section.subBlocs; track $index) {
            <li [id]="subBloc.id">
                <h3>{{subBloc.h3Title}}</h3>

                <!-- subChild Bloc -->
                @if(subBloc.subchildBlocs) {
                <ul>
                    @for(subChild of subBloc.subchildBlocs ; track $index) {
                    <li>
                        <h4 class="documentation__h4Title">{{subChild.h4Title}}</h4>
                        <p  class="documentation__text">{{subChild.text}}</p>

                        <h5>{{subChild.h5Title}}</h5>



                        <!-- Terminal -->
                        @if(subChild.terminal) {
                           @for(terminal of subChild.terminal ; track $index) {
                           <div [class]="`bg-${terminal.bgColor} border-${terminal.borderColor}`">
                               <p>
                                   {{terminal.type}}
                                </p>
                                <code>
                                  <pre>
                                      {{terminal.code}}
                                  </pre>
                                </code>
                            </div>
                           }
                        }


                        <!-- Arrays -->
                        @if(subChild.arrays) {
                        @for (array of subChild.arrays; track $index) {
                        <table>
                            <thead>
                                <tr>
                                    @for (header of array.headCol; track $index) {
                                    <th>{{header}}</th>
                                    }
                                </tr>
                            </thead>
                            <tbody>
                                @for (row of array.rows; track $index) {
                                <tr>
                                    @for (header of array.headCol; track $index) {
                                    <td>
                                        @let columnKey = 'col' + ($index + 1);
                                        @for (item of row[columnKey]; track $index) {
                                        <span [ngClass]="item.label ? 'tag': ''">{{item.text}}</span>
                                        }
                                    </td>
                                    }
                                </tr>
                                }
                            </tbody>
                        </table>
                        }
                        }



                        <!-- List -->
                        @if (subChild.list) {
                        <ul>
                            @for (item of subChild.list ; track $index) {
                            <li>
                                <p>
                                    {{item}}
                                </p>
                            </li>
                            }
                        </ul>
                        }



                        <!-- Label List -->
                        @if (subChild.labels) {
                        <ul>
                            @for (label of subChild.labels ; track $index) {
                            <li>
                                <p><span>{{label.label}}</span>
                                    {{label.text}}
                                </p>
                            </li>
                            }
                        </ul>
                        }



                        <!-- Alert boxes -->
                        @if (subChild.alerts) {
                        <ul>
                            @for (alert of subChild.alerts ; track $index) {
                            <li class="documentation__alert" [ngClass]="`bg-${alert.bgColor} border-${alert.borderColor}`">
                                <p  class="documentation__text-p"><span>{{alert.icon}}</span>{{alert.text}}</p>
                            </li>
                            }
                        </ul>
                        }
                    </li>
                    }
                </ul>
                }

                <!-- Arrays -->
                @if(subBloc.arrays) {
                @for (array of subBloc.arrays; track $index) {
                <table>
                    <thead>
                        <tr>
                            @for (header of array.headCol; track $index) {
                            <th>{{header}}</th>
                            }
                        </tr>
                    </thead>
                    <tbody>
                        @for (row of array.rows; track $index) {
                        <tr>
                            @for (header of array.headCol; track $index) {
                            <td>
                                @let columnKey = 'col' + ($index + 1);
                                @for (item of row[columnKey]; track $index) {
                                <span [ngClass]="item.label ? 'tag': ''">{{item.text}}</span>
                                }
                            </td>
                            }
                        </tr>
                        }
                    </tbody>
                </table>
                }
                }
            </li>
            }
        </ul>
        }
    </section>
    }
</div>